extends layout
block styles
  link(rel='stylesheet', href=Config.ASSET_CDN + '/stylesheets/index.css')
  link(rel='stylesheet', href=Config.ASSET_CDN + '/stylesheets/app.css')
  link(rel='stylesheet', href='https://use.fontawesome.com/releases/v5.2.0/css/all.css')

block scripts
  script(src='https://unpkg.com/infinite-scroll@3/dist/infinite-scroll.pkgd.min.js')
  script(src=Config.ASSET_CDN + '/javascripts/app.js')
  script(src=Config.ASSET_CDN + '/javascripts/index.js')

block page_name
  - stdlayout = false;
  = _("Almond")

block content
  if authenticated
    div#cloud-id-holder(data-cloud-id=user.cloud_id, data-auth-token=user.auth_token)

  div#page-body
    section.divider#section-heading
      h1 Almond
      h2 The Open Virtual Assistant

    div.sections

      if WITH_THINGPEDIA === 'embedded'
        section.divider#section-commandpedia
          h3= _("Popular Commands")
          div.container#commandpedia
            div.navbar.navbar-default#command-list-navbar
              form.navbar-form.navbar-left(action='', method='get')
                div.form-group
                  input.form-control#command-search-box(type='text', name='q', placeholder=_("I want to find a command..."))
                  button.btn.btn-primary#command-search-button(type="submit")= _("Search")
                div.form-group
                  button.btn.btn-primary#command-reset-button= _("Reset")
              button(data-toggle='modal',data-target='#commandpedia-new-command').navbar-btn.btn.btn-primary= _("Add a New Command")
              div.modal.fade#commandpedia-new-command(role='dialog')
                div.modal-dialog
                  div.modal-content
                    div.modal-header
                      a.close(data-dismiss='modal', aria-label="Close")
                        span(aria-hidden='true') Ã—

                      h4.modal-title= _("Add New Command")

                    form#form-new-command
                      div.modal-body
                        input(type='hidden', name='_csrf', value=csrfToken)

                        div.form-group
                          label(for='input-command-utterance').control-label= _("Command")
                          input.form-control#input-command-utterance(name="description", required=true, placeholder=_("What does the command accomplish?"))
                        div#results-container.hidden
                          p= _("Do you mean:")
                          ul#results
                        div#results-fail.hidden
                          p= _("Sorry, I did not understand that.")
                            |
                            |
                            a(href='#')#results-fail-write-thingtalk= _("Write ThingTalk code manually.")
                        div(hidden=true).form-group#thingtalk-group
                          label(for='input-command-thingtalk').control-label= _("ThingTalk Code")
                          a('href'='/doc/thingtalk-intro.md')= _(" (How to write ThingTalk?)")
                          textarea.form-control#input-command-thingtalk(name="code", placeholder=_("Code Here..."))
                          span.help-block#thingtalk-error
                          p
                            = _("Don't know how to write ThingTalk, or do you suspect this command is not supported?")
                            |
                            |
                            a#suggest-command-no-thingtalk(href='#')= _("Suggest this command for future inclusion instead.")

                        div(hidden=true).form-group#confirmation-group
                          label(for='input-command-confirmation').control-label= _("Please confirm this is what you would like your command to do:")
                          textarea.form-control#input-command-confirmation(name="code", readonly=true)
                      div.modal-footer
                        div.row
                          div.col-sm-6.col-md-4.col-md-offset-4.col-sm-offset-3
                            button(type='submit').form-control.btn.btn-primary.btn-block#submit= _("Add")

          div.row.aligned-grid#command-container
          br
          div.row
            div.col-sm-6.col-md-4.col-md-offset-4.col-sm-offset-3

        section.divider
          h3= _("Still Not Seeing What You Want?")
          div.container
            div.row
              div.col-sm-6.col-md-4.col-md-offset-4.col-sm-offset-3
                a(href='/thingpedia').btn.btn-primary.btn-block= _("Explore Thingpedia")
