extends layout

block styles
  link(rel='stylesheet', href='/stylesheets/apps.css')

block scripts
  script(src='/js/app-create.js', type='text/javascript')

block content
  - var action, page_h1;
  - if(op === 'create')
    - action = '/apps/create';
    - page_h1 = "Create a new app";
  - else if(op === 'fork')
    - action = '/apps/fork/' + fork_id
    - page_h1 = "Fork a app"
  - else if(op === 'edit')
    - action = '/apps/edit/' + app_id
    - page_h1 = "Edit App"
  - else
    - throw new TypeError('Invalid op');

  h1= page_h1

  form(action=action, method='post', data-toggle='validator')
    input(type='hidden',name='_csrf',value=csrfToken)

    div.container
      if error
        div.row
          div.col-sm-12
            div.alert.alert-danger.alert-dismissible.fade.in(role='alert')
              button(type='button', data-dismiss='alert', aria-label="Close").close
                span(aria-hidden='true') Ã—
              p= error

      if op === 'fork'
        div.row
          div.col-sm-12
            p You are forking app "
              a(href='/app/' + fork_id)= fork_name
              | " by 
              a(href='/user/profile/' + fork_owner)= fork_owner_name
              | . This will result in a new app with your changes.

      div.row
        div.col-sm-12
          div.form-group
            label(for='input-app-name').control-label App Name:
            input.form-control#input-app-name(type="text",name="name",required=true,value=name)

          div.form-group
            label(for='input-app-description').control-label App Description:
            textarea.form-control#input-app-description(name="description",required=true,placeholder="What does the app accomplish?")= description

          div.form-group
            label(for='input-app-code').control-label App Specification:
            textarea.form-control#input-app-code(name="code",required=true,placeholder="Code Here...")= code

          div.form-group
            label.control-label Tags
            p.form-control-static
              span#tag-container
                each tag, i in tags
                  span.label.label-default(id='tag-' + i).input-tag #{tag} | 
                    a.tag-remove(data-target='#tag-' + i, aria-label='Remove tag')
                      span.glyphicon-minus
                    input(type='hidden', name='tags[]', value=tag)
                  |  
              |  
              input(type='text', placeholder='Add tag...').form-inline#add-tag-input
      div.row
        div.col-sm-2
          if op === 'edit'
            button(type='submit').form-control.btn.btn-primary.btn-block Save
          else
            button(type='submit').form-control.btn.btn-primary.btn-block Create
